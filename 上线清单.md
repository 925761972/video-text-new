# 飞书多维表格插件上线动作与代码补齐清单

本文将“需要补齐的上线动作（按优先级）”与“代码层面待补齐项（可直接着手）”整理为可执行清单，逐项核对避免遗漏。

## 官方流程与审核要点（核对依据）

- 插件发布流程要求：创建插件、配置构成、开发与调试、联调测试、打包并在后台发布版本 [飞书项目帮助中心](https://project.feishu.cn/b/helpcenter/1p8d7djs/nh4exbsn)
- 自建应用发版审核会关注权限、数据范围、可用范围等变更，并走企业审核流程 [自建应用发版审核指南](https://www.feishu.cn/hc/zh-CN/articles/374230668270-%E8%87%AA%E5%BB%BA%E5%BA%94%E7%94%A8%E5%8F%91%E7%89%88%E5%AE%A1%E6%A0%B8%E6%8C%87%E5%8D%97)

## 需要补齐的上线动作（按优先级）

### P0 必做（影响审核与可用性）

- [ ] 在开发者后台完成插件基础信息、图标、截图、类目、短描述、详细介绍
- [ ] 配置插件构成与资源加载方式，确保多维表格内可加载（含资源 ID 与生效端配置） [飞书项目帮助中心](https://project.feishu.cn/b/helpcenter/1p8d7djs/nh4exbsn)
- [ ] 设置权限、数据范围、可用范围并提交版本审核 [自建应用发版审核指南](https://www.feishu.cn/hc/zh-CN/articles/374230668270-%E8%87%AA%E5%BB%BA%E5%BA%94%E7%94%A8%E5%8F%91%E7%89%88%E5%AE%A1%E6%A0%B8%E6%8C%87%E5%8D%97)
- [ ] 部署生产环境：前端与后端同域或配置反向代理，确保 `/api/*` 可访问
- [ ] 补齐支付与订阅生产参数：支付宝/微信/聚合回调与支付网关
- [ ] 完整隐私政策与用户协议对外可访问，并在后台填入链接
- [ ] 端到端联调测试：选字段、转写、失败重试、订阅支付、试用耗尽与恢复

### P1 高优先（降低运维与纠纷风险）

- [ ] 配置持久化存储，避免订阅与计费数据因重启丢失
- [ ] 订阅与计费对账：出单、回调、开通时效、失败补偿
- [ ] 设置服务可观测性：错误日志、关键链路告警、请求耗时统计
- [ ] 明确数据处理与删除流程，支持用户自助或工单
- [ ] 确认文件格式与大小限制与文案一致

### P2 优化项（提升体验与转化）

- [ ] 订阅页展示动态计费单价与单位
- [ ] 批量任务的处理进度与失败项导出
- [ ] 多语言与默认配置优化

## 代码层面具体待补齐项（可直接着手）

### 运行配置与环境变量

- [ ] 补齐生产环境变量（勿在仓库中存放敏感信息）
  - VOLC_APP_ID、VOLC_ACCESS_KEY、VOLC_RESOURCE_ID
  - SUBSCRIPTION_STORE_PATH、ADMIN_BASE_IDS、PAID_BASE_IDS、TRIAL_LIMIT、SUBSCRIPTION_BYPASS
  - BILLING_PAYMENT_URL、BILLING_WEBHOOK_TOKEN
  - ALIPAY_GATEWAY、ALIPAY_APP_ID、ALIPAY_PRIVATE_KEY、ALIPAY_NOTIFY_URL、ALIPAY_RETURN_URL、ALIPAY_PUBLIC_KEY
  - WECHATPAY_PUBLIC_KEY、WECHATPAY_API_V3_KEY
  - ADMIN_TOKEN、NODE_ENV、PORT
- [ ] 确认生产环境读取策略与密钥管理方式

### 订阅与计费

- [ ] 订阅与计费持久化：当前依赖文件路径，需确认线上可写且可持久
- [ ] 支付回调安全：校验签名与回调来源，确保成功后触发开通
- [ ] 订阅计划配置与展示一致：前端展示与后端定价保持同步

### 业务逻辑与交互一致性

- [ ] 前端显示的计费单价当前为固定文案，建议改为后端实时返回
- [ ] 仅前端校验附件格式与大小，建议服务端兜底校验
- [ ] `/api` 依赖同源部署，若分离部署需添加 CORS 或网关

### 安全与合规

- [ ] 隐私政策与用户协议扩展为完整对外文档并可访问
- [ ] 数据删除与工单支持流程落地（可在 UI 增加入口或说明）

### 测试与质量

- [ ] 添加端到端测试用例覆盖订阅与支付回调流程
- [ ] 运行现有测试并补齐失败场景用例

## 代码位置索引（便于逐项定位）

- 订阅与计费后端入口：[index.js](file:///Users/shijue/Downloads/Trae/solo/video-%20text/server/index.js)
- 前端请求与转写逻辑：[main.js](file:///Users/shijue/Downloads/Trae/solo/video-%20text/src/main.js)
- 订阅与计费存储：[subscription.js](file:///Users/shijue/Downloads/Trae/solo/video-%20text/server/stores/subscription.js)、[billing.js](file:///Users/shijue/Downloads/Trae/solo/video-%20text/server/stores/billing.js)
